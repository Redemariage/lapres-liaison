<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Single-Item Carousel - Fallback Removal</title>

  <style>
    body { 
      margin: 0; 
      padding: 0; 
      background: #f0f0f0; 
      font-family: Arial, sans-serif; 
    }
    .container {
      max-width: 600px;
      margin: 40px auto;
      background: #fff;
      padding: 20px;
      border: 1px solid #ccc;
    }
    h1 { text-align: center; }

    /* Each testimonial in the DOM */
    .testimonial-item {
      background: #fafafa;
      border: 1px solid #ccc;
      margin: 10px 0;
      padding: 10px;
      border-radius: 8px;
      text-align: center;
    }
    .testimonial-item img {
      width: 60px; 
      height: 60px;
      border-radius: 50%;
      margin-bottom: 10px;
    }
    .stars { color: gold; }

    /* Carousel layout */
    .carousel-wrapper {
      position: relative;
      width: 100%;
      overflow: hidden; /* so slides can move side to side */
      margin-top: 20px;
      border: 1px solid #ddd;
    }
    .slides {
      display: flex;
      transition: transform 0.4s ease;
    }
    .slide {
      width: 100%; /* each slide is 100% of the .carousel-wrapper */
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
      box-sizing: border-box;
    }

    /* Dots */
    .carousel-dots {
      text-align: center;
      margin-top: 15px;
    }
    .dot {
      display: inline-block;
      width: 14px;
      height: 14px;
      margin: 0 5px;
      background: #bbb;
      border-radius: 50%;
      cursor: pointer;
    }
    .dot.active {
      background: #333;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Minimal Single-Item Carousel (Fallback Removal)</h1>

    <!-- 3 Testimonials: each is .testimonial-item -->
    <div class="testimonial-item">
      <img src="https://via.placeholder.com/60" alt="Client1">
      <p>Testimonial #1 text goes here.</p>
      <div class="stars">★★★★★</div>
    </div>
    <div class="testimonial-item">
      <img src="https://via.placeholder.com/60" alt="Client2">
      <p>Testimonial #2 text goes here.</p>
      <div class="stars">★★★★★</div>
    </div>
    <div class="testimonial-item">
      <img src="https://via.placeholder.com/60" alt="Client3">
      <p>Testimonial #3 text goes here.</p>
      <div class="stars">★★★★★</div>
    </div>

    <!-- Carousel structure -->
    <div class="carousel-wrapper">
      <div class="slides" id="carousel-track"><!-- JS will insert .slide elements here --></div>
    </div>
    <div class="carousel-dots" id="carousel-dots"></div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function() {
      console.log("DOM loaded. Setting up the carousel...");

      // 1) Grab all .testimonial-item elements
      const testimonials = document.querySelectorAll('.testimonial-item');
      console.log("Found .testimonial-item count:", testimonials.length);

      const track = document.getElementById('carousel-track');
      const dotsContainer = document.getElementById('carousel-dots');

      // Convert NodeList to array
      const itemsArray = Array.from(testimonials);

      // 2) Remove them from the DOM to re-insert them in "slide" containers
      itemsArray.forEach((item, idx) => {
        if (item.parentNode) {
          console.log(`Removing item #${idx+1} from DOM...`);
          item.parentNode.removeChild(item); // fallback approach
        }
      });

      // 3) Create a .slide for each testimonial
      itemsArray.forEach((item, i) => {
        const slideDiv = document.createElement('div');
        slideDiv.classList.add('slide');
        slideDiv.appendChild(item);
        track.appendChild(slideDiv);
        console.log(`Created slide #${i+1}`);
      });

      const allSlides = track.querySelectorAll('.slide');
      const totalSlides = allSlides.length;
      console.log("Total slides:", totalSlides);

      let currentSlide = 0;

      // 4) Create dots
      const dots = [];
      for (let i = 0; i < totalSlides; i++) {
        const dot = document.createElement('span');
        dot.classList.add('dot');
        dot.addEventListener('click', () => {
          currentSlide = i;
          updateCarousel();
          resetAutoSlide();
        });
        dotsContainer.appendChild(dot);
        dots.push(dot);
      }

      function updateCarousel() {
        track.style.transform = `translateX(-${currentSlide * 100}%)`;
        dots.forEach((dot, idx) => {
          dot.classList.toggle('active', idx === currentSlide);
        });
        console.log(`Showing slide #${currentSlide + 1}`);
      }

      // 5) Auto-slide
      let autoSlideInterval = setInterval(nextSlide, 5000);

      function nextSlide() {
        currentSlide++;
        if (currentSlide >= totalSlides) {
          currentSlide = 0;
        }
        updateCarousel();
      }
      function resetAutoSlide() {
        clearInterval(autoSlideInterval);
        autoSlideInterval = setInterval(nextSlide, 5000);
      }

      // 6) Initialize
      if (totalSlides > 0) {
        currentSlide = 0;
        updateCarousel();
      }

      console.log("Carousel setup complete.");
    });
  </script>
</body>
</html>
